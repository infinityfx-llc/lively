"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./_rollupPluginBabelHelpers-7a0b7756.js"),t=require("react"),i=require("./pop-4d766072.js");function r(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=r(t),o=function(r){e._inherits(h,r);var n,o,a,s,l,c,p,u=e._createSuper(h);function h(t){var i;for(var r in e._classCallCheck(this,h),(i=u.call(this,t)).hover=!1,i.hasFocus=!1,i.inView=!1,i.scrollDelta=0,i.viewportMargin=t.viewportMargin,i.elements=[],i.animations={default:i.toAnimation(i.props.animate)},i.props.animations)i.animations[r]=i.toAnimation(i.props.animations[r]);return i.level=0,i.children=[],i}return e._createClass(h,[{key:"toAnimation",value:function(t){return!t||"object"!==e._typeof(t)&&"function"!=typeof t?null:"use"in t?t.use():new i.Animation(e._objectSpread2(e._objectSpread2({},t),{},{scaleCorrection:this.props.scaleCorrection}),this.props.initial)}},{key:"countNestedLevels",value:function(e){var i=this;if(!e)return 0;var r=0,n=0;return t.Children.forEach(e,(function(e){var o;if(t.isValidElement(e)){e.type===h&&(r=1);var a=i.countNestedLevels(null===(o=e.props)||void 0===o?void 0:o.children);n=n<a?a:n}})),n+r}},{key:"componentDidMount",value:function(){var e=this;this.elements.forEach((function(t){var i;null===(i=e.animations.default)||void 0===i||i.setInitialStyles(t)})),(this.props.parentLevel<1||this.props.noCascade)&&(this.scrollEventListener=this.onScroll.bind(this),i.addEventListener("scroll",this.scrollEventListener),this.props.onMount&&this.play(this.props.onMount,{staggerDelay:.001,immediate:!0}),this.props.whileViewport&&this.onScroll())}},{key:"componentWillUnmount",value:function(){i.removeEventListener("scroll",this.scrollEventListener),this.props.onUnmount&&(this.props.parentLevel<1||this.props.noCascade)&&this.play(this.props.onUnmount,{reverse:!0,immediate:!0})}},{key:"inViewport",value:function(){var t=this,i=!0,r=!0;return this.elements.forEach((function(e){var n=e.getBoundingClientRect().y;i=i&&n+e.clientHeight*(1-t.viewportMargin)<window.innerHeight,r=r&&n>window.innerHeight+e.clientHeight*t.viewportMargin})),this.elements.length||this.children.forEach((function(t){var n=t.animatable.inViewport(),o=e._slicedToArray(n,2),a=o[0],s=o[1];i=i&&a,r=r&&s})),[i,r]}},{key:"onScroll",value:(p=e._asyncToGenerator(e._regeneratorRuntime().mark((function t(){var i,r,n,o;return e._regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(Date.now()-this.scrollDelta<350)){t.next=2;break}return t.abrupt("return");case 2:this.scrollDelta=Date.now(),i=this.inViewport(),r=e._slicedToArray(i,2),n=r[0],o=r[1],!this.inView&&n&&(this.inView=!0,this.props.whileViewport&&this.play(this.props.whileViewport)),this.inView&&o&&(this.inView=!1,this.props.whileViewport&&this.play(this.props.whileViewport,{reverse:!0,immediate:!0}));case 6:case"end":return t.stop()}}),t,this)}))),function(){return p.apply(this,arguments)})},{key:"onEnter",value:(c=e._asyncToGenerator(e._regeneratorRuntime().mark((function t(i){var r,n=arguments;return e._regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=n.length>1&&void 0!==n[1]&&n[1],this.hover||(this.props.whileHover&&this.play(this.props.whileHover),this.hover=!0),r&&r(i);case 3:case"end":return e.stop()}}),t,this)}))),function(e){return c.apply(this,arguments)})},{key:"onLeave",value:(l=e._asyncToGenerator(e._regeneratorRuntime().mark((function t(i){var r,n=arguments;return e._regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=n.length>1&&void 0!==n[1]&&n[1],this.hover&&(this.props.whileHover&&this.play(this.props.whileHover,{reverse:!0}),this.hover=!1),r&&r(i);case 3:case"end":return e.stop()}}),t,this)}))),function(e){return l.apply(this,arguments)})},{key:"onFocus",value:(s=e._asyncToGenerator(e._regeneratorRuntime().mark((function t(i){var r,n=arguments;return e._regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=n.length>1&&void 0!==n[1]&&n[1],this.hasFocus||(this.props.whileFocus&&this.play(this.props.whileFocus),this.hasFocus=!0),r&&r(i);case 3:case"end":return e.stop()}}),t,this)}))),function(e){return s.apply(this,arguments)})},{key:"onBlur",value:(a=e._asyncToGenerator(e._regeneratorRuntime().mark((function t(i){var r,n=arguments;return e._regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=n.length>1&&void 0!==n[1]&&n[1],this.hasFocus&&(this.props.whileFocus&&this.play(this.props.whileFocus,{reverse:!0}),this.hasFocus=!1),r&&r(i);case 3:case"end":return e.stop()}}),t,this)}))),function(e){return a.apply(this,arguments)})},{key:"onClick",value:(o=e._asyncToGenerator(e._regeneratorRuntime().mark((function t(i){var r,n=arguments;return e._regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=n.length>1&&void 0!==n[1]&&n[1],this.props.onClick&&this.play(this.props.onClick),r&&r(i);case 3:case"end":return e.stop()}}),t,this)}))),function(e){return o.apply(this,arguments)})},{key:"play",value:(n=e._asyncToGenerator(e._regeneratorRuntime().mark((function t(r){var n,o,a,s,l,c,p,u,h,v,d,m,f,y,g,b,_=this,w=arguments;return e._regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=w.length>1&&void 0!==w[1]?w[1]:{},o=n.callback,a=n.reverse,s=void 0!==a&&a,l=n.immediate,c=void 0!==l&&l,p=n.cascade,u=void 0!==p&&p,h=n.groupAdjust,v=void 0===h?0:h,d=n.cascadeDelay,m=void 0===d?0:d,f=n.staggerDelay,y=void 0===f?0:f,!(this.props.parentLevel>0)||u){e.next=3;break}return e.abrupt("return");case 3:if(g="string"==typeof r?this.animations[r]:this.animations.default){e.next=6;break}return e.abrupt("return");case 6:b=0,this.elements.forEach((function(e,t){var i="group"in _.props?_.props.parentLevel-_.props.group:_.level+v;m=s?g.duration:m;var r=s?i*m:(_.props.parentLevel-i)*m;r=_.props.stagger*t+r+y,b=r>b?r:b,g.play(e,{delay:r,reverse:s,immediate:c})})),this.children.forEach((function(e){var t=e.animatable,i=e.staggerIndex,n=void 0===i?-1:i;null==t||t.play(r,{reverse:s,immediate:c,cascade:!0,staggerDelay:n<0?0:_.props.stagger*n,cascadeDelay:g.duration,groupAdjust:n<0?0:1})})),o&&i.AnimationQueue.delay(o,b+g.duration);case 10:case"end":return e.stop()}}),t,this)}))),function(e){return n.apply(this,arguments)})},{key:"style",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=e._objectSpread2(e._objectSpread2({},t),{},{transitionProperty:"transform, opacity, clip-path, border-radius, background-color, color, width, height, left, top",willChange:"transform"});return i}},{key:"mergeProperties",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e._objectSpread2(e._objectSpread2({},i),t);for(var n in r)["children","parentLevel","ref"].includes(n)?delete r[n]:"object"===e._typeof(t[n])&&"object"===e._typeof(i[n])&&(r[n]=e._objectSpread2(e._objectSpread2({},i[n]),t[n]));return r}},{key:"deepClone",value:function(i){var r,n=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=o.index,s=void 0===a?0:a,l=o.useElements,c=void 0!==l&&l,p=o.useEvents,u=void 0!==p&&p;if(!t.isValidElement(i))return i;var v,d={};i.type!==h&&(c&&(d={style:this.style(null===(v=i.props)||void 0===v?void 0:v.style),ref:function(e){return n.elements[s]=e}}),u&&(this.props.parentLevel<1||this.props.noCascade)&&(d=e._objectSpread2(e._objectSpread2({},d),{},{onMouseEnter:function(e){var t;return n.onEnter(e,null===(t=i.props)||void 0===t?void 0:t.onMouseEnter)},onMouseLeave:function(e){var t;return n.onLeave(e,null===(t=i.props)||void 0===t?void 0:t.onMouseLeave)},onFocus:function(e){var t;return n.onFocus(e,null===(t=i.props)||void 0===t?void 0:t.onFocus)},onBlur:function(e){var t;return n.onBlur(e,null===(t=i.props)||void 0===t?void 0:t.onBlur)},onClick:function(e){var t;return n.onClick(e,null===(t=i.props)||void 0===t?void 0:t.onClick)}}),u=!1));i.type!==h||null!==(r=i.props)&&void 0!==r&&r.noCascade||(d=e._objectSpread2(e._objectSpread2(e._objectSpread2({},d),this.mergeProperties(i.props,this.props)),{},{parentLevel:this.parentLevel>0?this.parentLevel:this.level,ref:function(e){return n.children[n.children.length]={animatable:e,staggerIndex:c?s:-1}}}));var m=t.Children.map(i.props.children,(function(e,t){return n.deepClone(e,{index:t,useEvents:u})}));return Object.values(d).length?t.cloneElement(i,d,m):i}},{key:"render",value:function(){var e=this;return this.level=this.countNestedLevels(this.props.children),t.Children.map(this.props.children,(function(t,i){return e.deepClone(t,{index:i,useElements:!0,useEvents:!0})}))}}]),h}(t.Component);e._defineProperty(o,"defaultProps",{scaleCorrection:!1,parentLevel:0,stagger:.1,viewportMargin:.25,animate:{},animations:{}});var a=["levels","animations"],s=function(i){e._inherits(s,i);var r=e._createSuper(s);function s(t){var i;return e._classCallCheck(this,s),(i=r.call(this,t)).levels=i.props.levels,i.animations=new Array(i.levels).fill(0).map((function(e,t){return t<i.props.animations.length?i.props.animations[t]:i.props.animations[i.props.animations.length-1]})),i}return e._createClass(s,[{key:"makeAnimatable",value:function(i){var r=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(s<1||t.Children.count(i)<1)return i;var l=this.props;l.levels,l.animations;var c=e._objectWithoutProperties(l,a),p=this.animations[this.levels-s];return s===this.levels&&(c.ref=function(e){return r.animatable=e}),n.default.createElement(o,e._extends({animate:p,scaleCorrection:p.scaleCorrection},c),t.Children.map(i,(function(e){return t.isValidElement(e)?t.cloneElement(e,{},r.makeAnimatable(e.props.children,s-1)):e})))}},{key:"play",value:function(t){var i,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};null===(i=this.animatable)||void 0===i||i.play(t,e._objectSpread2(e._objectSpread2({},r),{},{reverse:!0}))}},{key:"render",value:function(){return this.makeAnimatable(this.props.children,this.levels)}}]),s}(t.Component);e._defineProperty(s,"defaultProps",{levels:1,stagger:.1,viewportMargin:.25,animations:[i.Move,i.Pop]});var l=function(t){e._inherits(n,t);var r=e._createSuper(n);function n(t){var i;return e._classCallCheck(this,n),(i=r.call(this,t)).animations.morphs=[],i}return e._createClass(n,[{key:"componentDidMount",value:function(){var e=this,t=this.elements[0];t&&(i.Animation.setInitial(t),t.setAttribute("uitools-morph-id",this.props.id),t.setAttribute("uitools-morph-active",this.props.active),this.self=t,this.createResetAnimation(),i.AnimationQueue.delay((function(){for(var i=document.querySelectorAll('[uitools-morph-id="'.concat(e.props.id,'"]')),r=0;r<i.length;r++)i[r]!==t&&(e.createMorphAnimation(i[r],r),"true"!==i[r].getAttribute("uitools-morph-active")&&e.animations.transition.setInitialStyles(i[r]))}),.001))}},{key:"componentDidUpdate",value:function(){var e=this,t="true"===this.self.getAttribute("uitools-morph-active");this.self.setAttribute("uitools-morph-active",this.props.active),i.AnimationQueue.delay((function(){if(e.props.active&&!t)e.animations.transition.setInitialStyles(e.self),e.animations.transition.play(e.self);else if(!e.props.active&&t){for(var i=0,r=document.querySelectorAll('[uitools-morph-id="'.concat(e.props.id,'"]')),n=0;n<r.length;n++)if(r[n]!==e.self&&"true"===r[n].getAttribute("uitools-morph-active")){i=n;break}e.animations.morphs[i].play(e.self)}}),.001)}},{key:"createResetAnimation",value:function(){var e,t=null===(e=this.self.UITools)||void 0===e?void 0:e.initialStyles;this.animations.transition=new i.Animation({opacity:[0,0,1],scale:{x:1,y:1},position:{x:0,y:0},borderRadius:t.borderRadius,backgroundColor:[t.backgroundColor,t.backgroundColor,t.backgroundColor],scaleCorrection:this.scaleCorrection},{})}},{key:"createMorphAnimation",value:function(e,t){var r,n,o=null===(r=this.self.UITools)||void 0===r?void 0:r.initialStyles,a=null===(n=e.UITools)||void 0===n?void 0:n.initialStyles;this.animations.morphs[t]=new i.Animation({position:[{x:0,y:0},{x:a.x-o.x+(a.clientWidth-o.clientWidth)/2,y:a.y-o.y+(a.clientHeight-o.clientHeight)/2},{x:a.x-o.x+(a.clientWidth-o.clientWidth)/2,y:a.y-o.y+(a.clientHeight-o.clientHeight)/2}],scale:[{x:1,y:1},{x:a.clientWidth/o.clientWidth,y:a.clientHeight/o.clientHeight},{x:a.clientWidth/o.clientWidth,y:a.clientHeight/o.clientHeight}],opacity:[1,1,0],borderRadius:[o.borderRadius,a.borderRadius,a.borderRadius],backgroundColor:[o.backgroundColor,a.backgroundColor,a.backgroundColor],scaleCorrection:this.scaleCorrection},{})}}]),n}(o);e._defineProperty(l,"defaultProps",{id:0,active:!1,scaleCorrection:!1}),exports.Animatable=o,exports.Animate=s,exports.Morph=l;
