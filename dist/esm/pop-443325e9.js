import e from"@babel/runtime/helpers/defineProperty";import t from"@babel/runtime/helpers/objectWithoutProperties";import i from"@babel/runtime/helpers/asyncToGenerator";import n from"@babel/runtime/helpers/slicedToArray";import r from"@babel/runtime/helpers/toConsumableArray";import a from"@babel/runtime/helpers/typeof";import o from"@babel/runtime/helpers/classCallCheck";import s from"@babel/runtime/helpers/createClass";import c from"@babel/runtime/regenerator";var l=function(){function e(){o(this,e),this.queue=[],this.tick()}var t,n;return s(e,[{key:"tick",value:(n=i(c.mark((function e(){var t,i;return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=Date.now(),i=0;case 2:if(!(i<this.queue.length+1)){e.next=10;break}if(!(this.queue.length===i||this.queue[i].timestamp>t)){e.next=6;break}return this.queue.splice(0,i),e.abrupt("break",10);case 6:this.queue[i].callback();case 7:i++,e.next=2;break;case 10:requestAnimationFrame(this.tick.bind(this));case 11:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"search",value:function(e){for(var t,i,n=0,r=this.queue.length-1;n<=r;)if(t=n+r>>>1,(i=this.queue[t].timestamp-e.timestamp)<0)n=t+1;else{if(!(i>0))return t;r=t-1}return n}},{key:"insert",value:function(e){var t=this.search(e);this.queue.splice(t,0,e)}},{key:"delay",value:function(e,t){e instanceof Function&&this.insert({callback:e,timestamp:Date.now()+1e3*t})}}],[{key:"get",value:function(){return"Lively"in window||(window.Lively={}),"AnimationLoop"in window.Lively||(window.Lively.AnimationQueue=new e),window.Lively.AnimationQueue}},{key:"delay",value:(t=i(c.mark((function e(t,i){return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.get().delay(t,i));case 1:case"end":return e.stop()}}),e,this)}))),function(e,i){return t.apply(this,arguments)})},{key:"sleep",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return new Promise((function(i){e.delay(i,t)}))}}]),e}(),u=function(e){var t=e.match(/^#([\da-f]{1,2})([\da-f]{1,2})([\da-f]{1,2})([\da-f]{2})?/i),i=n(t,5);i[0];var r=i[1],a=i[2],o=i[3],s=i[4];return{r:parseInt(r.padStart(2,r),16),g:parseInt(a.padStart(2,a),16),b:parseInt(o.padStart(2,o),16),a:void 0!==s?parseInt(s,16):255}},p=function(e){var t=e.match(/^rgba?\((\d+)\D+(\d+)\D+(\d+)\D*(\d+)?\)/i),i=n(t,5);i[0];var r=i[1],a=i[2],o=i[3],s=i[4];return{r:parseInt(r),g:parseInt(a),b:parseInt(o),a:void 0!==s?parseInt(s):255}},y=function(e,t){var i;if(t instanceof Function){null!==(i=window.Lively)&&void 0!==i&&i.Events||(window.Lively={Events:{}}),e in window.Lively.Events||(window.Lively.Events[e]={unique:0},window.addEventListener(e,(function(t){Object.values(window.Lively.Events[e]).forEach((function(e){e instanceof Function&&e(t)}))})));var n=window.Lively.Events[e];t.Lively={ListenerID:n.unique},n[n.unique++]=t}},d=function(e,t){var i,n,r;"undefined"!=typeof window&&null!==(i=window.Lively)&&void 0!==i&&null!==(n=i.Events)&&void 0!==n&&n[e]&&null!=t&&null!==(r=t.Lively)&&void 0!==r&&r.ListenerID&&delete window.Lively.Events[e][t.Lively.ListenerID]},f=function(e){"Lively"in e||(e.Lively={queue:[],initials:{}}),e.Lively.style||(e.Lively.style=function(e){for(var t={},i=0;i<e.style.length;i++)t[e.style[i]]=e.style[e.style[i]];return t}(e),e.Lively.style.transitionProperty="transform, opacity, clip-path, border-radius, font-size, background-color, color, width, height, padding",e.Lively.style.willChange="transform"),e.style={},function(e,t){for(var i in t)e.style[i]=t[i]}(e,e.Lively.style);var t=getComputedStyle(e),i=t.paddingLeft,n=t.paddingRight,r=t.paddingTop,a=t.paddingBottom,o=t.backgroundColor,s=t.color,c=t.borderRadius,l=t.padding,u=t.fontSize,p=e.getBoundingClientRect(),y=p.x,d=p.y;e.Lively.initials={x:y,y:d,paddingLeft:i,paddingRight:n,paddingTop:r,paddingBottom:a,backgroundColor:o,color:s,fontSize:u,width:e.offsetWidth+"px",height:e.offsetHeight+"px",borderRadius:c.split(" ")[0],padding:l.split(" ")[0]}},v=["delay","duration","repeat","interpolate","origin","useLayout"],h=function(){function e(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=i.delay,r=void 0===n?0:n,a=i.duration,s=void 0===a?1:a,c=i.repeat,l=void 0===c?1:c,u=i.interpolate,p=void 0===u?"ease":u,y=i.origin,d=void 0===y?{x:.5,y:.5}:y,f=i.useLayout,h=void 0!==f&&f,g=t(i,v),b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o(this,e),this.useLayout=h,this.keyframes=this.getKeyframes(g,b),this.delay=r,this.duration=s,this.delta=s/(this.keyframes.length-1),this.interpolation="spring"===p?"cubic-bezier(0.65, 0.34, 0.7, 1.42)":p,this.origin=this.originToStyle(d),this.repeat=l}var y;return s(e,[{key:"originToStyle",value:function(e){var t=.5,i=.5;if("object"===a(e))t=e.x,i=e.y;else if("string"==typeof e)switch(e){case"left":t=0;break;case"right":t=1;break;case"top":i=0;break;case"bottom":i=1}else t=i=e;return"".concat(100*t,"% ").concat(100*i,"%")}},{key:"getKeyframes",value:function(t){var i=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=0,o=function(o){var s=o in n?n[o]:e.initials[o];Array.isArray(t[o])||(t[o]=[t[o]]),t[o]=t[o].length>1?t[o]:[s].concat(r(t[o])),t[o]=t[o].map((function(e){return i.sanitize(o,e)})),a=t[o].length>a?t[o].length:a};for(var s in t)o(s);return new Array(a).fill(0).map((function(n,r){var o={};for(var s in t)s in e.initials&&(o[s]=i.interpolateKeyframe(t[s],r,a));return i.keyframeToStyle(o)}))}},{key:"sanitize",value:function(t,i){var n=this,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("string"==typeof i){if(i.match(/^#[0-9a-f]{3,8}$/i))return u(i);if(i.match(/^rgba?\(.*\)$/i))return p(i);var o=parseFloat(i),s=i.match(/[^0-9\.]*$/i);return isNaN(o)?e.initials[t]:("%"===s&&(o/=100),s?[o,s]:o)}if("object"===a(i)){var c=Object.keys(i);("x"in i||"y"in i)&&(c=["x","y"]),("r"in i||"g"in i||"b"in i||"a"in i)&&(c=["r","g","b","a"]),("left"in i||"right"in i||"top"in i||"bottom"in i)&&(c=["left","right","top","bottom"]),c.forEach((function(e){i[e]=n.sanitize(t,i[e],e)}))}return void 0!==i?i:r?e.initials[t][r]:e.initials[t]}},{key:"interpolate",value:function(e,t,i){if("number"!=typeof e||"number"!=typeof t)return i>.5?t:e;var n=!1;Array.isArray(e)&&(n=e[1],e=e[0]),Array.isArray(t)&&(n=t[1],t=t[0]);var r=e*(1-i)+t*i;return n?[r,n]:r}},{key:"interpolateKeyframe",value:function(e,t,i){var n=this;if(e.length===i)return e[t];var r=t*((e.length-1)/(i-1)),o=Math.floor(r),s=e[o];if(o===e.length-1)return s;var c=e[o+1];if("object"===a(s)){var l={};return Object.keys(s).forEach((function(e){l[e]=n.interpolate(s[e],c[e],r-o)})),l}return this.interpolate(s,c,r-o)}},{key:"toString",value:function(e,t){return Array.isArray(e)&&(t=e[1],e=e[0]),e*("%"===t?100:1)+t}},{key:"toLength",value:function(e){return Array.isArray(e)&&(e="px"===e[1]?e[0]+"px":e[0]),e}},{key:"keyframeToStyle",value:function(e){var t=this,i={transform:""};return Object.entries(e).forEach((function(e){var r=n(e,2),a=r[0],o=r[1];switch(a){case"position":i.transform+="translate(".concat(t.toString(o.x,"px"),", ").concat(t.toString(o.y,"px"),") ");break;case"scale":if("number"==typeof o&&(o={x:o,y:o}),t.useLayout){i.width=t.toLength(o.x),i.height=t.toLength(o.y);break}i.transform+="scale(".concat(t.toString(o.x,"%"),", ").concat(t.toString(o.y,"%"),") ");break;case"rotation":i.transform+="rotate(".concat((t.toString(o),"deg"),") ");break;case"clip":i.clipPath="inset(".concat(t.toString(o.top,"%")," ").concat(t.toString(o.right,"%")," ").concat(t.toString(o.bottom,"%")," ").concat(t.toString(o.left,"%"),")");break;case"borderRadius":case"padding":case"fontSize":i[a]=t.toString(o,"px");break;case"backgroundColor":case"color":i[a]="rgba(".concat(o.r,", ").concat(o.g,", ").concat(o.b,", ").concat(o.a,")");break;case"interact":i.pointerEvents=o?"all":"none";break;case"opacity":case"active":i[a]=o}})),i.transform.length||delete i.transform,i}},{key:"setInitial",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t&&f(e),e.style.transitionDuration="0s",e.style.transitionTimingFunction=this.interpolation,e.style.transformOrigin=this.origin;var i=this.keyframes[0];this.apply(e,i,!0)}},{key:"setLength",value:function(e,t,i,n,r){var a=e.Lively.initials[i],o=parseInt(e.Lively.initials[n]),s=parseInt(e.Lively.initials[r]),c=t[i],l=t.padding?1:o/s;"string"==typeof c&&(c="calc(".concat(c," / ").concat(a,")"));var u=t.padding?t.padding:o+s+"px";e.style[i]="max(calc(".concat(a," * ").concat(c," - ").concat("border-box"!==e.style.boxSizing?"0px":u,"), 0px)");var p="calc(min(calc(".concat(a," * ").concat(c,"), ").concat(u,") * ");e.style[n]=p+.5*l,e.style[r]=p+1/l*.5}},{key:"apply",value:(y=i(c.mark((function e(t,i){var r,a,o=this,s=arguments;return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=s.length>2&&void 0!==s[2]&&s[2],!("active"in i)){e.next=11;break}if("start"!==(a=Object.keys(i.active)[0])&&!r){e.next=10;break}if(t.style.display=i.active[a]?"":"none",r){e.next=8;break}return e.next=8,l.sleep(.001);case 8:e.next=11;break;case 10:l.delay((function(){t.style.display=i.active[a]?"":"none"}),this.delta);case 11:Object.entries(i).forEach((function(e){var r=n(e,2),a=r[0],s=r[1];return"width"===a?o.setLength(t,i,"width","paddingLeft","paddingRight"):"height"===a?o.setLength(t,i,"height","paddingTop","paddingBottom"):void("active"===a||"padding"===a&&(i.width||i.height)||(t.style[a]=s))}));case 12:case"end":return e.stop()}}),e,this)}))),function(e,t){return y.apply(this,arguments)})},{key:"start",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=t.immediate,n=void 0!==i&&i,r=t.reverse,a=void 0!==r&&r,o=t.repeat,s=void 0===o?this.repeat:o;!e.Lively.animating||n?(this.setInitial(e),e.style.transitionDuration="".concat(this.delta,"s"),e.Lively.animating=!0,e.Lively.index=1,this.getNext(e,a,s)):e.Lively.queue.push([this,{reverse:a,repeat:s}])}},{key:"play",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=i.delay,r=void 0===n?0:n,a=i.immediate,o=void 0!==a&&a,s=i.reverse,c=void 0!==s&&s;e.style&&(this.delay||r?l.delay((function(){return t.start(e,{immediate:o,reverse:c})}),this.delay+r):this.start(e,{immediate:o,reverse:c}))}},{key:"getNext",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(e.Lively.index===this.keyframes.length){e.Lively.animating=!1;var a=e.Lively.queue.shift()||[],o=n(a,2),s=o[0],c=o[1];return s?s.start(e,c):void(r>1&&this.start(e,{reverse:i,repeat:r-1}))}var u=e.Lively.index;i&&(u=this.keyframes.length-1-u),requestAnimationFrame((function(){t.apply(e,t.keyframes[u])})),e.Lively.index++,l.delay((function(){return t.getNext(e,i,r)}),this.delta)}}]),e}();e(h,"initials",{opacity:1,scale:{x:1,y:1},position:{x:0,y:0},clip:{left:0,top:0,right:0,bottom:0},borderRadius:0,padding:0,fontSize:"1em",backgroundColor:{r:127,g:127,b:127,a:255},color:{r:127,g:127,b:127,a:255},active:{start:!0},interact:!0});var g=["direction"];function b(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function m(t){for(var i=1;i<arguments.length;i++){var n=null!=arguments[i]?arguments[i]:{};i%2?b(Object(n),!0).forEach((function(i){e(t,i,n[i])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function k(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return k.use=k.use.bind(k,e),k}function w(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function x(t){for(var i=1;i<arguments.length;i++){var n=null!=arguments[i]?arguments[i]:{};i%2?w(Object(n),!0).forEach((function(i){e(t,i,n[i])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function L(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return L.use=L.use.bind(L,e),L}k.use=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=e.direction,n=void 0===i?"up":i,r=t(e,g),a="0px",o="20px";switch(n){case"down":o="-20px";break;case"left":a="20px",o="0px";break;case"right":a="-20px",o="0px"}return new h(m({position:{x:"0px",y:"0px"},opacity:1,duration:.5},r),{position:{x:a,y:o},opacity:0})},L.use=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new h(x({opacity:1,scale:1,duration:.25},e),{opacity:0,scale:.85})};export{h as A,k as M,L as P,y as a,l as b,f as c,d as r};
